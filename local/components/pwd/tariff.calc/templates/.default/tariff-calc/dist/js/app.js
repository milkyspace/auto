(function(e){function t(t){for(var n,i,c=t[0],l=t[1],o=t[2],p=0,m=[];p<c.length;p++)i=c[p],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&m.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(m.length)m.shift()();return s.push.apply(s,o||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,c=1;c<a.length;c++){var l=a[c];0!==r[l]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={app:0},s=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var o=0;o<c.length;o++)t(c[o]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"01a4":function(e,t,a){"use strict";var n=a("624a"),r=a.n(n);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("4de4"),a("b680"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"calc-content"},[a("div",{staticClass:"calc-content__left"},[1===e.step?a("CalcListParams"):e._e(),2===e.step?a("CalcUserData"):e._e(),3===e.step?a("CalcSuccessSend"):e._e()],1),a("div",{staticClass:"calc-content__right"},[a("CalcSelectedTarifs")],1)])},s=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"calc-sum"},[e._l(e.calculatedTarifs.tariffs,(function(t,n){return a("div",{key:n,staticClass:"calc-sum-item"},[a("div",{staticClass:"calc-sum-item__price"},[e._v(e._s(e._f("price")(t.quantity*t.price))+" руб. / мес.")]),e._l(t.options,(function(t,r){return a("p",{key:n+"_"+r},[e._v(" "+e._s(t.quantity)+"x * "),a("span",{staticClass:"medium"},[e._v(e._s(e._f("price")(t.price))+" руб.")])])})),a("p",[e._v(e._s(t.quantity)+"x * "),a("span",{staticClass:"medium"},[e._v(e._s(e._f("price")(t.price))+" руб.")])]),a("p",[e._v(e._s(t.name))])],2)})),a("div",{staticClass:"calc-sum-total"},[a("div",{staticClass:"calc-sum-total__title"},[e._v(e._s(e._f("price")(e.calculatedTarifs.total.price))+" руб/мес.")]),a("div",{staticClass:"calc-sum-total__desc"},[e._v("Общая стоимость")])])],2)},c=[],l={name:"CalcSelectedTarifs"},o=l,u=a("2877"),p=Object(u["a"])(o,i,c,!1,null,"08fd23ef",null),m=p.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-send"},[a("div",{staticClass:"form-send__row"},[a("label",{staticClass:"form-send__label",attrs:{for:""}},[e._v("Количество пользователей:")]),a("CalcIntInput",{attrs:{nameProperty:"countUsers",changeEvent:"recalculate",initValue:"1"}})],1),e._l(e.listParams,(function(t,n){return a("div",{key:n,staticClass:"form-send__row"},[a("label",{staticClass:"form-send__label",attrs:{for:""}},[e._v(e._s(t.NAME)+":")]),"BOOL"===t.TYPE?a("CalcBoolInput",{key:n,attrs:{nameProperty:t.NAME,changeEvent:e.recalculate}}):e._e(),"LIST_INT"===t.TYPE?a("CalcRangeInput",{key:n,attrs:{nameProperty:t.NAME,changeEvent:e.recalculate}}):e._e(),"INT"===t.TYPE?a("CalcIntInput",{key:n,attrs:{nameProperty:t.NAME,changeEvent:e.recalculate,initValue:0}}):e._e()],1)})),a("div",{staticClass:"form-send__row"},[a("button",{staticClass:"btn-blue form-send__btn",attrs:{type:"submit"},on:{click:e.nextStep}},[e._v("Отправить заявку")])])],2)},f=[],d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"slider-input"}},[a("div",{staticClass:"calc-values-container"},e._l(e.all,(function(t){return a("span",{staticClass:"calc-value"},[e._v(e._s(t))])})),0),a("div",{staticClass:"ui-slider-handle",attrs:{id:"custom-handle"}})])},v=[],_=a("1157"),C=a.n(_),g=(a("401c"),{name:"CalcRangeInput",props:["nameProperty","changeEvent"],data:function(){return{value:1,min:1,max:1,all:[1]}},mounted:function(){var e=this.$store.getters.slider;if(e){this.value=e.current,this.min=e.min,this.max=e.max,this.all=e.all,this.setCurrentParam(this.nameProperty,this.value);var t=this;C()("#custom-handle");C()("#slider-input").slider({min:this.min,max:this.max,values:[this.value],step:this.all[1]-this.all[0],create:function(){},slide:function(e,a){t.setCurrentParam(t.nameProperty,a.value)}})}}}),y=g,P=(a("01a4"),Object(u["a"])(y,d,v,!1,null,null,null)),b=P.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"number"},[a("span",{staticClass:"minus",on:{click:e.decr}},[a("b")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"text-input",attrs:{type:"text",size:"5"},domProps:{value:e.value},on:{change:e.changeValue,input:function(t){t.target.composing||(e.value=t.target.value)}}}),a("div",{staticClass:"plus",on:{click:e.incr}},[a("b")])])},k=[],I=(a("d81d"),{name:"CalcIntInput",data:function(){return{value:0}},mounted:function(){this.value=parseInt(this.initValue),this.setCurrentParam(this.nameProperty,this.value)},watch:{value:function(e,t){if(""==e&&(this.value=0),e>this.$store.state.selectedOptions["countUsers"]&&"countUsers"!=this.nameProperty&&(this.value=parseInt(t)),"countUsers"==this.nameProperty){var a=this;this.$root.$children[0].$children[0].$children.map((function(e){"CalcIntInput"==e.$options._componentTag&&"countUsers"!=e.nameProperty&&(console.log({paramComponentvalue:e.value,paramComponent:e,selfUserComponent:a.value}),e.value>a.value&&e.updateValue(a.value))}))}this.setCurrentParam(this.nameProperty,this.value)}},methods:{incr:function(){this.value=this.value+1},decr:function(){this.value>=1&&(this.value=this.value-1)},updateValue:function(e){this.value=e}},props:["nameProperty","changeEvent","initValue"]}),E=I,x=Object(u["a"])(E,T,k,!1,null,"53601b18",null),N=x.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"check form-send__check--custom"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{id:"r23",type:"checkbox",name:"s2"},domProps:{checked:Array.isArray(e.value)?e._i(e.value,null)>-1:e.value},on:{change:[function(t){var a=e.value,n=t.target,r=!!n.checked;if(Array.isArray(a)){var s=null,i=e._i(a,s);n.checked?i<0&&(e.value=a.concat([s])):i>-1&&(e.value=a.slice(0,i).concat(a.slice(i+1)))}else e.value=r},e.changeValue]}}),a("label",{attrs:{for:"r23"}})])},S=[],w={name:"CalcBoolInput",props:["nameProperty","changeEvent"],data:function(){return{value:!1}},mounted:function(){this.setCurrentParam(this.nameProperty,this.value)}},M=w,A=Object(u["a"])(M,O,S,!1,null,"14b65eea",null),$=A.exports,j={name:"CalcListParams",computed:{},methods:{},components:{CalcRangeInput:b,CalcIntInput:N,CalcBoolInput:$}},U=j,q=Object(u["a"])(U,h,f,!1,null,"081e8632",null),L=q.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-send"},[a("div",{staticClass:"form-send__row"},[a("label",{staticClass:"form-send__label",attrs:{for:""}},[e._v("Ваше имя")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"text-input",attrs:{type:"text",placeholder:"Имя",required:""},domProps:{value:e.name},on:{change:e.changeName,input:function(t){t.target.composing||(e.name=t.target.value)}}}),e.errorName.length>0?a("p",{staticStyle:{color:"red"}},[e._v(e._s(e.errorName))]):e._e()]),a("div",{staticClass:"form-send__row"},[a("label",{staticClass:"form-send__label",attrs:{for:""}},[e._v("Телефон")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],staticClass:"text-input phone_input_vue",attrs:{type:"tel",placeholder:"Телефон",required:""},domProps:{value:e.phone},on:{change:e.changePhone,input:function(t){t.target.composing||(e.phone=t.target.value)}}}),e.errorPhone.length>0?a("p",{staticStyle:{color:"red"}},[e._v(e._s(e.errorPhone))]):e._e()]),a("div",{staticClass:"form-send__row"},[a("label",{staticClass:"form-send__label",attrs:{for:""}},[e._v("E-mail")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"text-input",attrs:{type:"email",placeholder:"E-mail",required:""},domProps:{value:e.email},on:{change:e.changeEmail,input:function(t){t.target.composing||(e.email=t.target.value)}}}),e.errorMail.length>0?a("p",{staticStyle:{color:"red"}},[e._v(e._s(e.errorMail))]):e._e()]),a("div",{staticClass:"check form-send__check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.check,expression:"check"}],attrs:{id:"r21",type:"checkbox",name:"s2",required:""},domProps:{checked:Array.isArray(e.check)?e._i(e.check,null)>-1:e.check},on:{keypress:e.changeCheck,change:function(t){var a=e.check,n=t.target,r=!!n.checked;if(Array.isArray(a)){var s=null,i=e._i(a,s);n.checked?i<0&&(e.check=a.concat([s])):i>-1&&(e.check=a.slice(0,i).concat(a.slice(i+1)))}else e.check=r}}}),a("label",{attrs:{for:"r21"}},[e._v("Согласие на обработку персональных данных")]),e.errorCheck.length>0?a("p",{staticStyle:{color:"red"}},[e._v(e._s(e.errorCheck))]):e._e()]),a("div",{staticClass:"form-send__row"},[a("button",{staticClass:"btn-blue form-send__btn",attrs:{type:"button"},on:{click:e.send}},[e._v("Отправить заявку")])])])},V=[],Y=(a("b0c0"),a("498a"),{name:"CalcUserData",data:function(){return{name:"",errorName:"",phone:"",errorPhone:"",email:"",errorMail:"",check:!0,errorCheck:""}},mounted:function(){var e=this;C()((function(){window.jQuery(".phone_input_vue").inputmask("+7 (999) 999-99-99"),window.jQuery(".phone_input_vue").change((function(){e.phone=C()(this).val()}))}))},methods:{changeName:function(){this.errorName="",0==this.name.trim().length&&(this.errorName="обязательно для заполнения")},changePhone:function(){if(console.log(this.phone),this.errorPhone="",0==this.phone.trim().length)this.errorPhone="обязательно для заполнения";else{var e=/^\+7 \(\d{3}\) \d{3}-\d{2}-\d{2}$/;0==e.test(this.phone.trim())&&(this.errorPhone="невалидный телефон")}},changeEmail:function(){if(this.errorMail="",0==this.email.trim().length)this.errorMail="обязательно для заполнения";else{var e=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;0==e.test(this.email.trim())&&(this.errorMail="введите корректный адресс почты")}},changeCheck:function(){this.errorCheck="",0==this.check&&(this.errorCheck="не активно сошлашение")},send:function(){if(this.validate()){var e=this;C.a.post("/local/components/pwd/tariff.calc/templates/.default/ajax.php",{method:"send-form",name:this.name,phone:this.phone,email:this.email,data:this.$store.state.calculatedTarifs,sessid:C()("#sessid").val()}).done((function(t){t.success&&e.nextStep()}))}},validate:function(){return this.changeName(),this.changePhone(),this.changeEmail(),this.changeCheck(),!(this.errorName.length>0||this.errorPhone.length>0||this.errorMail.length>0||this.errorCheck.length>0)}},components:{}}),D=Y,B=Object(u["a"])(D,R,V,!1,null,"0f80340c",null),z=B.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("h3",[e._v("Заявка успешно отправленнв")])},J=[],Q={name:"CalcSuccessSend"},F=Q,G=Object(u["a"])(F,Z,J,!1,null,"05d776fe",null),H=G.exports,K={name:"App",components:{CalcListParams:L,CalcSelectedTarifs:m,CalcUserData:z,CalcSuccessSend:H},mounted:function(){this.$store.dispatch("setParamsTarifs")}},W=K,X=Object(u["a"])(W,r,s,!1,null,null,null),ee=X.exports,te=(a("1276"),a("2f62"));n["a"].use(te["a"]);var ae=new te["a"].Store({state:{userName:"",userPhone:"",userEmail:"",checkConvention:!1,paramsTarifs:[],step:1,selectedOptions:{},calculatedTarifs:{tariffs:[],total:{price:0}}},mutations:{setMutationTarifs:function(e,t){e.paramsTarifs=t},incrementeStep:function(e){e.step++},setDefaultProperty:function(e,t){e.selectedOptions[t["PROPERTY"]]},setCurrentParam:function(e,t){e.selectedOptions[t.param]=t.value;var a=[],n=0,r=parseInt(e.selectedOptions["countUsers"]),s=r,i=!1;r>0&&e.paramsTarifs.tariffs&&e.paramsTarifs.tariffs.map((function(t){var s=t.PARAMS.split(","),c=!1,l=!1,o=!1,u={};e.paramsTarifs.propertys.map((function(t){"BOOL"==t.TYPE&&0==i&&(i=t),"LIST_INT"==t.TYPE&&(u[t.ID]=t),s.map((function(a){if(t.ID==a){var n=e.selectedOptions[t.SECTION_NAME];switch(t.TYPE){case"INT":n>0&&(l={property:t,value:parseInt(n)});break;case"LIST_INT":n==parseInt(t.NAME)&&(o={property:t,value:parseInt(n)});break}}}))}));var p=r;if(p>0&&(0!=l?0!=o?(c=t,r-=p):e.paramsTarifs.tariffs.map((function(t){var a=t.PARAMS.split(",");a.map((function(a){e.paramsTarifs.propertys.map((function(n){if(n.ID==a&&"LIST_INT"==n.TYPE){var s=parseInt(e.selectedOptions[n.SECTION_NAME]);s==parseInt(n.NAME)&&(c=t,r-=l.value,p=l.value)}}))}))})):0!=o&&(c=t),!1!==c)){var m={quantity:p,name:t.NAME,price:parseInt(t.PRICE)};a.push(m),n+=m.quantity*m.price}})),0!=i&&1==e.selectedOptions["Файловое хранилище"]&&(a.push({quantity:s,name:i.NAME,price:parseInt(i.PRICE)}),n+=parseInt(i.PRICE)*s),e.calculatedTarifs={tariffs:a,total:{price:n}}}},actions:{setParamsTarifs:function(e){C.a.post("/local/components/pwd/tariff.calc/templates/.default/ajax.php",{method:"get-calc-params"}).done((function(t){t.success&&e.commit("setMutationTarifs",t.tarifs)}))}},getters:{listParams:function(e){return e.paramsTarifs.sections?e.paramsTarifs.sections:[]},slider:function(e){var t=[];return e.paramsTarifs.propertys.map((function(e){"LIST_INT"==e.TYPE&&t.push(parseInt(e.NAME))})),t.length>0&&{current:Math.min.apply(Math,t),min:Math.min.apply(Math,t),max:Math.max.apply(Math,t),all:t}},calculatedTarifs:function(e){return e.calculatedTarifs},countUsers:function(e){return parseInt(e.selectedOptions["countUsers"])}},modules:{}}),ne={computed:{listParams:function(){return this.$store.getters.listParams},countUsers:function(){return this.$store.getters.countUsers},step:function(){return this.$store.state.step},calculatedTarifs:function(){return this.$store.getters.calculatedTarifs}},methods:{setCurrentParam:function(e,t){this.value=t,this.$store.commit("setCurrentParam",{param:e,value:t})},nextStep:function(){this.$store.commit("incrementeStep")},changeValue:function(){this.setCurrentParam(this.nameProperty,this.value)}}};C()((function(){n["a"].config.productionTip=!1,n["a"].mixin(ne),n["a"].filter("price",(function(e){var t=(e/1).toFixed(0).replace(".",",");return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")})),new n["a"]({store:ae,render:function(e){return e(ee)}}).$mount("#vue-calc-container")}))},"624a":function(e,t,a){}});
//# sourceMappingURL=app.js.map